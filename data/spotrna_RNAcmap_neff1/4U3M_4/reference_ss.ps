%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.9
%%CreationDate: Wed Feb 19 12:01:34 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
AAACUUUCAACAACGGAUCUCUUGGUUCUCGCAUCGAUGAAGAACGCAGCGAAAUGCGAUACGUAAUGUGAAUUGCAGAAUUCCGUGAAUCAUCGAAUCUUUGAACGCACAUUGCGCCCCUUGGUAUUCCAGGGGGCAUGCCUGUUUGAGCGUCAUUU\
) def
/coor [
[110.16979980 294.63217163]
[114.17981720 279.64221191]
[126.25605011 269.89828491]
[125.36743927 254.92462158]
[116.88975525 242.67807007]
[123.79593658 228.44377136]
[122.90732574 213.47010803]
[122.01872253 198.49645996]
[121.13011169 183.52279663]
[120.24150085 168.54914856]
[119.20500946 153.58499146]
[118.02073669 138.63182068]
[102.32200623 140.93693542]
[87.49565887 137.33912659]
[75.59441376 128.80215454]
[64.32904053 138.70626831]
[53.06366348 148.61036682]
[41.79828644 158.51448059]
[30.53291321 168.41857910]
[25.79620361 184.11875916]
[9.77142811 187.60281372]
[-1.05649853 175.28665161]
[4.45126581 159.84007263]
[20.62880516 157.15321350]
[31.89418030 147.24909973]
[43.15955734 137.34500122]
[54.42493057 127.44088745]
[65.69030762 117.53678131]
[61.59374619 103.10701752]
[46.80479431 100.59963989]
[32.01584625 98.09226227]
[17.22689438 95.58489227]
[2.43794274 93.07751465]
[-12.39766026 90.86281586]
[-27.27412224 88.94165802]
[-42.15058517 87.02050018]
[-56.82807541 92.92658997]
[-68.45955658 83.62294006]
[-83.33602142 81.70178986]
[-94.71578979 92.42721558]
[-110.33026886 93.27696991]
[-122.80677032 83.84983826]
[-126.25428009 68.59700775]
[-119.04498291 54.72041321]
[-104.58288574 48.77214432]
[-89.69655609 53.56080246]
[-81.41486359 66.82532501]
[-66.53839874 68.74648285]
[-52.92497635 62.70297623]
[-40.22943115 72.14403534]
[-25.35296631 74.06519318]
[-10.47650337 75.98635101]
[-6.17760849 73.79685211]
[-0.45148328 74.32212830]
[4.94531822 78.28856659]
[19.73427010 80.79593658]
[34.52322006 83.30331421]
[49.31217194 85.81069183]
[64.10112000 88.31806183]
[76.78246307 68.70021820]
[99.18634033 59.81824112]
[123.30355072 65.77050781]
[139.96873474 85.17892456]
[145.46855164 71.22356415]
[150.96836853 57.26820755]
[156.46818542 43.31285095]
[161.96800232 29.35749054]
[167.46781921 15.40213299]
[172.96763611 1.44677496]
[178.46745300 -12.50858307]
[172.41363525 -26.86090279]
[178.19003296 -40.93527222]
[191.91007996 -46.61821365]
[197.40989685 -60.57357025]
[197.65194702 -69.75930023]
[203.15869141 -74.74855804]
[208.93315125 -88.59253693]
[214.70761108 -102.43650818]
[220.48208618 -116.28047943]
[226.11949158 -130.18083191]
[231.61930847 -144.13618469]
[237.11912537 -158.09153748]
[242.61894226 -172.04690552]
[240.48037720 -187.72290039]
[252.34535217 -196.72689819]
[257.84515381 -210.68225098]
[263.34497070 -224.63761902]
[263.52722168 -241.59057617]
[279.86810303 -246.10852051]
[288.73309326 -231.65693665]
[277.30032349 -219.13780212]
[271.80050659 -205.18243408]
[266.30068970 -191.22708130]
[268.83264160 -176.54925537]
[256.57431030 -166.54708862]
[251.07447815 -152.59172058]
[245.57466125 -138.63636780]
[240.07484436 -124.68100739]
[240.55070496 -117.26544952]
[234.32604980 -110.50601959]
[228.55158997 -96.66204834]
[222.77713013 -82.81806946]
[217.00267029 -68.97409821]
[211.36524963 -55.07375336]
[205.86543274 -41.11839676]
[212.01943970 -27.60307884]
[206.64064026 -13.37201405]
[192.42280579 -7.00876713]
[186.92298889 6.94659138]
[181.42317200 20.90194893]
[175.92335510 34.85730743]
[170.42353821 48.81266403]
[164.92373657 62.76802444]
[159.42391968 76.72338104]
[153.92410278 90.67874146]
[160.50854492 104.15631866]
[174.89714050 108.39523315]
[189.28573608 112.63414001]
[203.67431641 116.87305450]
[218.06291199 121.11196899]
[232.45150757 125.35088348]
[246.84010315 129.58979797]
[261.22869873 133.82870483]
[275.61727905 138.06761169]
[291.42187500 133.69183350]
[302.92236328 145.38246155]
[298.28805542 161.11315918]
[282.28631592 164.70156860]
[271.37838745 152.45620728]
[256.98977661 148.21730042]
[242.60119629 143.97839355]
[228.21260071 139.73947144]
[213.82400513 135.50056458]
[199.43540955 131.26164246]
[185.04681396 127.02273560]
[170.65821838 122.78382111]
[156.26962280 118.54491425]
[150.44569397 123.27056885]
[163.03381348 131.42774963]
[159.16578674 145.92044067]
[144.18713379 146.72021484]
[138.79783630 132.72189331]
[132.97390747 137.44754028]
[134.15818787 152.40072632]
[137.97290039 160.76040649]
[135.21516418 167.66053772]
[136.10375977 182.63418579]
[136.99237061 197.60784912]
[137.88098145 212.58149719]
[138.76959229 227.55516052]
[147.31083679 240.87272644]
[140.34109497 254.03601074]
[141.22970581 269.00967407]
[154.37362671 277.25692749]
[160.12840271 291.66738892]
[156.28123474 306.69998169]
[144.31141663 316.57437134]
[128.82159424 317.49359131]
] def
/pairs [
[3 153]
[4 152]
[6 150]
[7 149]
[8 148]
[9 147]
[10 146]
[11 144]
[12 143]
[15 28]
[16 27]
[17 26]
[18 25]
[19 24]
[29 59]
[30 58]
[31 57]
[32 56]
[33 55]
[34 52]
[35 51]
[36 50]
[38 48]
[39 47]
[63 115]
[64 114]
[65 113]
[66 112]
[67 111]
[68 110]
[69 109]
[70 108]
[73 105]
[74 104]
[76 103]
[77 102]
[78 101]
[79 100]
[80 98]
[81 97]
[82 96]
[83 95]
[85 93]
[86 92]
[87 91]
[116 137]
[117 136]
[118 135]
[119 134]
[120 133]
[121 132]
[122 131]
[123 130]
[124 129]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
